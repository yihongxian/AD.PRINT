(this["webpackJsonpad-pcedit"]=this["webpackJsonpad-pcedit"]||[]).push([[0],{285:function(e,t,a){e.exports=a(558)},331:function(e,t){},393:function(e,t,a){},394:function(e,t,a){"use strict";a.r(t);var n=a(27),r=a(43),o=Object(n.c)({editModalInfo:{visible:!1},dataSource:r.a.getItem()||[]});t.default={namespace:"catalog",state:o,subscriptions:{},effects:{},reducers:{removeCatalog:function(e,t){var a=t.payload,n=e.deleteIn(["dataSource",a]);return r.a.setItem(n.get("dataSource").toJS()),n},modifyCatalogs:function(e,t){var a=t.payload;return e.withMutations((function(e){var t,o=e.get("dataSource"),i=e.get("editModalInfo").toJS(),c=i.id,l=i.isCreate,u={pn:a.pn,name:a.name};l?(t=o.size,u.id=Date.now()):(t=o.findIndex((function(e){return e.get("id")===c})),u.id=c),e.setIn(["dataSource",t],Object(n.c)(u)),r.a.setItem(e.get("dataSource").toJS()),e.set("editModalInfo",Object(n.c)({visible:!1}))}))},updateEditModalInfo:function(e,t){var a=t.payload;return e.set("editModalInfo",Object(n.c)(a))}}}},395:function(e,t,a){"use strict";a.r(t);var n=a(27),r=a(43),o=Object(n.c)({editModalInfo:{visible:!1},relationModalInfo:{visible:!1},relations:r.d.getItem()||[],dataSource:r.b.getItem()||[]});t.default={namespace:"category",state:o,subscriptions:{},effects:{},reducers:{removeCategory:function(e,t){var a=t.payload,n=e.deleteIn(["dataSource",a]);return r.b.setItem(n.get("dataSource").toJS()),n},modifyCategories:function(e,t){var a=t.payload;return e.withMutations((function(e){var t,o=e.get("dataSource"),i=e.get("editModalInfo").toJS(),c=i.id,l=i.isCreate,u={name:a.name};l?(u.id=Date.now(),t=o.size):(u.id=c,t=o.findIndex((function(e){return e.get("id")===c}))),a.children&&a.children.length?u.children=a.children:u.children=[{id:u.id,name:"\u9ed8\u8ba4",isDefault:!0}],e.setIn(["dataSource",t],Object(n.c)(u)),r.b.setItem(e.get("dataSource").toJS()),e.set("editModalInfo",Object(n.c)({visible:!1}))}))},updateEditModalInfo:function(e,t){var a=t.payload;return e.set("editModalInfo",Object(n.c)(a))},showRelationModal:function(e,t){var a=t.payload;return e.withMutations((function(e){var t=e.get("relations").reduce((function(e,t){return t.get("categoryId")===a?e.push(t.get("catalogId")):e}),Object(n.a)());e.set("relationModalInfo",Object(n.c)({visible:!0,categoryId:a,targetKeys:t}))}))},hideRelationModal:function(e){return e.set("relationModalInfo",Object(n.b)({visible:!1}))},updateTargetKeys:function(e,t){var a=t.payload;return e.setIn(["relationModalInfo","targetKeys"],Object(n.a)(a))},confirmSaveRelations:function(e){return e.withMutations((function(e){var t=e.get("relationModalInfo"),a=t.get("categoryId"),o=e.get("relations").toSet().filterNot((function(e){return e.get("categoryId")===a})).withMutations((function(e){t.get("targetKeys").forEach((function(t){e.add(Object(n.b)({categoryId:a,catalogId:t}))}))}));r.d.setItem(o.toJS()),e.set("relations",o.toList()),e.set("relationModalInfo",Object(n.b)({visible:!1}))}))},updateRelationModalInfo:function(e,t){var a=t.payload;return e.set("relationModalInfo",Object(n.c)(a))}}}},396:function(e,t,a){"use strict";a.r(t);var n=a(85),r=a(160),o=(a(140),a(52),a(39)),i=a(27),c=a(54),l=a(43),u=a(282),s=Object(i.c)({firstLevelCategoryId:void 0,secondLevelCategoryOptions:[]});t.default={namespace:"fileInput",state:Object(i.b)(),subscriptions:{setup:function(e){var t=e.dispatch;e.history.listen((function(e){e.pathname===c.b.FILE_INPUT&&t({type:"resetState"})}))}},effects:{},reducers:{resetState:function(){return s.set("files",Object(i.c)(l.c.getItem()||[]))},onFirstLevelCategoryChange:function(e,t){var a=t.payload;return e.withMutations((function(e){e.set("firstLevelCategoryId",a.firstId),e.set("secondLevelCategoryOptions",a.options)}))},onSecondLevelCategoryChange:function(e,t){var a=t.payload;return e.set("secondLevelCategoryId",a)},saveFile:function(e,t){var a=t.payload,c=a.time,s=a.catalogs,d=(a.firstLevelCategory,a.secondLevelCategory),f=Object(r.a)(a,["time","catalogs","firstLevelCategory","secondLevelCategory"]),m=l.c.getItem()||[];return f.id=Date.now(),f.time=c.valueOf(),f.categoryId=d,f.catalogs=s.reduce((function(e,t){return t.checked?[].concat(Object(n.a)(e),[Object(o.pick)(t,["id","pn","name"])]):e}),[]).sort((function(e,t){return e.pn-t.pn})),m.push(f),l.c.setItem(m),u.a.success("\u65b0\u589e\u6210\u529f\uff01"),e.set("files",Object(i.c)(m))},removeFile:function(e,t){var a=t.payload,n=l.c.getItem().filter((function(e){return e.id!==a}));return l.c.setItem(n),u.a.success("\u5220\u9664\u6210\u529f\uff01"),e.set("files",Object(i.c)(n))},modifyFile:function(e,t){var a=t.payload;l.c.getItem().find((function(e){return e.id===a}));return e}}}},43:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return d})),a.d(t,"b",(function(){return f}));var n=a(19),r=a(20),o=a(39),i=a(202),c=a.n(i),l=function(){function e(t){Object(n.a)(this,e),this.key=t}return Object(r.a)(e,[{key:"getItem",value:function(){var e=c.a.getItem(this.key);if("string"!==typeof e)return null;try{return JSON.parse(e)}catch(t){console.error(t)}}},{key:"setItem",value:function(e){Object(o.isArray)(e)?c.a.setItem(this.key,JSON.stringify(e)):console.error("\u4fdd\u5b58\u7684\u6570\u636e\u5e94\u8be5\u662f\u6570\u7ec4")}}]),e}(),u=new l("files"),s=new l("catalogs"),d=new l("relations"),f=new l("categories")},510:function(e,t,a){},54:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return r}));var n={CATALOG:"/catalog",CATALOG_LIST:"/catalog/list",CATEGORY:"/category",CATEGORY_LIST:"/category/list",CATEGORY_CREATE:"/category/create",CATEGORY_MODIFY:"/category/modify/:id",FILE_INPUT:"/file/input"},r=[{key:"home",linkTo:n.FILE_INPUT,iconType:"home",linkDesc:"\u4e3b\u9875"},{key:"catalog",linkTo:n.CATALOG,iconType:"profile",linkDesc:"\u76ee\u5f55"},{key:"category",linkTo:n.CATEGORY,iconType:"copy",linkDesc:"\u5206\u7c7b"}]},541:function(e,t,a){},542:function(e,t,a){},544:function(e,t,a){},556:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(44),i=a(559),c=a(19),l=a(20),u=a(23),s=a(22),d=a(24),f=a(204),m=a(207),p=a(11),h=a(53),g=a(54),v=i.a.Header,y={width:"100%",zIndex:1,position:"fixed",padding:0,backgroundColor:"white"},b={lineHeight:"62px"},O={position:"absolute",top:0,right:20};var j=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=function(e){var t=g.a.find((function(t){return Object(f.a)(t.linkTo).exec(e)||Object(f.a)("".concat(t.linkTo,"/(.*)")).exec(e)}));return t?[t.key]:[]}(this.props.location.pathname);return r.a.createElement(v,{style:y},r.a.createElement(m.a,{mode:"horizontal",selectedKeys:e,style:b},g.a.map((function(e){return r.a.createElement(m.a.Item,{key:e.key},r.a.createElement(o.Link,{to:e.linkTo},r.a.createElement(p.a,{type:e.iconType}),r.a.createElement("span",null,e.linkDesc)))}))),r.a.createElement("div",{style:O},r.a.createElement(h.a,{type:"dashed"},"\u5bfc\u51fa\u914d\u7f6e")))}}]),t}(r.a.Component),C=Object(o.withRouter)(j),E=a(0),I=a.n(E),k=a(29),w=a(27),S=a(564),M=a(156),R=a(122),x=a(563),L=a(279),T=a(561),F={labelCol:{span:7},wrapperCol:{span:15}},A={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:14}}},D=a(52),P=a(85),N=a(46),J=a(264),K=a.n(J),q=a(64),G=a(160),_=a(562),V=a(278),B=a(163),U=-1,z={beginDrag:function(e){return U=e.index,{index:e.index}},canDrag:function(e){return!e.isFocus}},Y=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.isOver,a=(e.isFocus,e.connectDragSource),n=e.connectDropTarget,o=(e.moveRow,Object(G.a)(e,["isOver","isFocus","connectDragSource","connectDropTarget","moveRow"])),i=Object(D.a)({},o.style,{cursor:"move"}),c=o.className;return t&&(o.index>U&&(c+=" drop-over-downward"),o.index<U&&(c+=" drop-over-upward")),a(n(r.a.createElement("tr",Object.assign({},o,{className:c,style:i}))))}}]),t}(r.a.Component),$=Object(B.d)("row",{drop:function(e,t){var a=t.getItem().index,n=e.index;a!==n&&(e.moveRow(a,n),t.getItem().index=n)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(Object(B.c)("row",z,(function(e){return{connectDragSource:e.dragSource()}}))(Y)),H=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.size,a=e.rowKey,n=e.onRow,o=e.columns,i=e.dataSource,c=e.pagination;return r.a.createElement(B.b,{backend:V.a},r.a.createElement(_.a,{size:t,rowKey:a,columns:o,dataSource:i,pagination:c,onRow:n,components:{body:{row:$}}}))}}]),t}(r.a.Component),W=a(39),Q=a(104),X=a(61),Z=a(565),ee=a(570),te={width:"100%"},ae=function(e){function t(e){var a;Object(c.a)(this,t),(a=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleChange=function(e){a.setState({value:e,isUpdate:!0})},a.handleAfterChange=function(){var e=a.state,t=e.value,n=e.isUpdate,r=a.props,o=r.onChange;(0,r.onFocusChange)(!1),n&&a.setState({isUpdate:!1},(function(){o&&o(t)}))};var n=e.value;return a.state={value:n,isUpdate:!1,prevValue:n},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!Object(W.isEqual)(e.disabled,this.props.disabled)||!Object(W.isEqual)(t.value,this.state.value)}},{key:"render",value:function(){var e=this.state.value,t=this.props,a=t.disabled,n=t.onFocusChange;return r.a.createElement(Q.a,{type:"flex",align:"middle"},r.a.createElement(X.a,{span:16},r.a.createElement(Z.a,{max:300,value:Object(W.isInteger)(e)?e:0,onChange:this.handleChange,onAfterChange:this.handleAfterChange,disabled:a})),r.a.createElement(X.a,{span:6,offset:1},r.a.createElement(ee.a,{min:0,max:300,value:e,onBlur:this.handleAfterChange,onFocus:function(){return n(!0)},onChange:this.handleChange,disabled:a,style:te})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!Object(W.isEqual)(e.value,t.prevValue)){var a=e.value;return{value:a,prevValue:a}}return null}}]),t}(r.a.Component),ne=(a(510),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleFocusChange=function(e){a.setState({isFocus:e})},a.handlePageNumChange=function(e){return function(t){var n=a.props,r=n.value,o=n.onChange,i=Object(P.a)(r),c=i[e];i[e]=Object(D.a)({},c,{pn:t}),o(i)}},a.getColumns=function(){return[{width:200,title:"\u9898\u76ee\u540d\u79f0",dataIndex:"name",render:function(e,t,a){return t.checked?e:r.a.createElement("span",{style:{color:"gray"}},e)}},{width:400,title:"\u9875\u53f7",dataIndex:"pn",render:function(e,t,n){return r.a.createElement(ae,{value:e,disabled:!t.checked,onChange:a.handlePageNumChange(n),onFocusChange:a.handleFocusChange})},onCell:function(){return{onClick:function(e){e.stopPropagation()}}}},{width:80,title:"\u9009\u62e9",dataIndex:"checked",render:function(e){return r.a.createElement(q.a,{checked:e})}}]},a.state={},a.handleRow=a.handleRow.bind(Object(N.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleRow",value:function(e,t){var a=this,n=this.state.isFocus,r=this.props.onChange;return{index:t,isFocus:n,moveRow:function(e,t){var n=a.props.value,o=n[e],i=K()(n,{$splice:[[e,1],[t,0,o]]});r(i)},onClick:function(){var e=a.props.value,n=Object(P.a)(e),o=n[t];n[t]=Object(D.a)({},o,{checked:!o.checked}),r(n)}}}},{key:"render",value:function(){var e=this.props.value;return r.a.createElement(H,{size:"small",rowKey:"id",columns:this.getColumns(),dataSource:e,onRow:this.handleRow,pagination:!1})}}]),t}(r.a.Component)),re=Object(k.connect)((function(e){return{catalogs:e.catalog.get("dataSource")}}))(ne),oe=S.a.Item,ie=M.a.Group,ce=R.a.Option,le={size:"small",style:{marginBottom:15}},ue=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).handleSubmit=function(e){e.preventDefault(),e.stopPropagation();var t=a.props,n=t.form,r=t.saveFile;n.validateFields((function(e,t){!e&&r(t)}))},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.form,a=e.firstLevelCategoryId,n=e.firstLevelCategoryOptions,o=e.secondLevelCategoryOptions,i=this.context.formRef,c=t.getFieldDecorator;return r.a.createElement(S.a,Object.assign({ref:i,onSubmit:this.handleSubmit},A),r.a.createElement(x.a,Object.assign({title:"\u6587\u4ef6\u5206\u7c7b"},le),r.a.createElement(oe,{label:"\u4e00\u7ea7\u5206\u7c7b"},c("firstLevelCategory",{rules:[{required:!0,message:"\u6587\u4ef6\u7c7b\u578b\u4e0d\u80fd\u4e3a\u7a7a"}]})(r.a.createElement(R.a,{placeholder:"\u8bf7\u9009\u62e9\u6587\u4ef6\u5206\u7c7b",showSearch:!0},n.toJS().map((function(e){var t=e.id,a=e.name;return r.a.createElement(ce,{key:t,value:t},a)}))))),a&&r.a.createElement(oe,{label:"\u4e8c\u7ea7\u5206\u7c7b"},c("secondLevelCategory")(r.a.createElement(ie,{options:o.toJS()})))),r.a.createElement(x.a,Object.assign({title:"\u57fa\u7840\u8bbe\u7f6e"},le),r.a.createElement(oe,{label:"\u7b2c\u4e00\u884c\u5c01\u9762\u5185\u5bb9"},c("covers[0]",{rules:[{required:!0,message:"\u7b2c\u4e00\u884c\u5c01\u9762\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"}]})(r.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u7b2c\u4e00\u884c\u5c01\u9762\u5185\u5bb9"}))),r.a.createElement(oe,{label:"\u7b2c\u4e8c\u884c\u5c01\u9762\u5185\u5bb9"},c("covers[1]")(r.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u7b2c\u4e8c\u884c\u5c01\u9762\u5185\u5bb9"}))),r.a.createElement(oe,{label:"\u7acb\u5377\u4eba"},c("creater",{rules:[{required:!0,message:"\u7acb\u5377\u4eba\u4e0d\u80fd\u4e3a\u7a7a"}]})(r.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u7acb\u5377\u4eba\u540d\u79f0"}))),r.a.createElement(oe,{label:"\u68c0\u67e5\u4eba"},c("checker",{rules:[{required:!0,message:"\u68c0\u67e5\u4eba\u4e0d\u80fd\u4e3a\u7a7a"}]})(r.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u68c0\u67e5\u4eba\u540d\u79f0"}))),r.a.createElement(oe,{label:"\u7533\u8bf7\u65f6\u95f4"},c("time",{rules:[{required:!0,message:"\u7533\u8bf7\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a"}]})(r.a.createElement(T.a,{style:{width:"100%"}})))),r.a.createElement(x.a,Object.assign({title:"\u76ee\u5f55\u8bbe\u7f6e"},le),c("catalogs")(r.a.createElement(re,null))),r.a.createElement(x.a,le,r.a.createElement(h.a,{type:"primary",htmlType:"submit",style:{width:"100%"}},"\u4fdd\u5b58")))}}]),t}(r.a.Component);ue.contextTypes={formRef:I.a.object};var se=Object(k.connect)((function(e){var t=e.category,a=e.catalog,n=e.fileInput;return{relations:t.get("relations"),allCatalogs:a.get("dataSource"),firstLevelCategoryId:n.get("firstLevelCategoryId"),firstLevelCategoryOptions:t.get("dataSource"),secondLevelCategoryOptions:n.get("secondLevelCategoryOptions")}}),{saveFile:function(e){return{type:"fileInput/saveFile",payload:e}},onFirstLevelCategoryChange:function(e){return{type:"fileInput/onFirstLevelCategoryChange",payload:e}},onSecondLevelCategoryChange:function(e){return{type:"fileInput/onSecondLevelCategoryChange",payload:e}}})(S.a.create({onValuesChange:function(e,t,a){if(t.hasOwnProperty("firstLevelCategory")){var n=e.form,r=e.relations,o=e.allCatalogs,i=e.firstLevelCategoryOptions,c=e.onFirstLevelCategoryChange,l=t.firstLevelCategory,u=i.findIndex((function(e){return e.get("id")===l})),s=i.getIn([u,"children"],Object(w.a)()).map((function(e){return Object(w.b)({label:e.get("name"),value:e.get("id"),disabled:e.get("isDefault")})})),d=o.withMutations((function(e){r.forEach((function(t){if(t.get("categoryId")===l){var a=e.findIndex((function(e){return e.get("id")===t.get("catalogId")}));a>=0&&e.setIn([a,"checked"],!0)}}))})).toJS();c({firstId:l,options:s}),setTimeout((function(){n.setFieldsValue({secondLevelCategory:s.getIn([0,"value"]),catalogs:d})}))}else if(t.hasOwnProperty("secondLevelCategory")){(0,e.onSecondLevelCategoryChange)(t.secondLevelCategory)}}})(ue)),de=a(281),fe=a(566),me=a(572),pe=a(568),he=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleRemove=a.handleRemove.bind(Object(N.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleRemove",value:function(){var e=this.props,t=e.id,a=e.name,n=e.onRemove;pe.a.confirm({title:"\u786e\u8ba4\u8981\u5220\u9664\u6587\u4ef6 ".concat(a," \u5417\uff1f"),content:"\u5220\u9664\u540e\u4e0d\u53ef\u6062\u590d\uff0c\u8bf7\u8c28\u614e\u64cd\u4f5c\uff01",onOk:function(){n(t)}})}},{key:"render",value:function(){var e=this.props.name;return r.a.createElement(Q.a,{type:"flex",align:"middle",justify:"space-between",className:"huali-file-item"},r.a.createElement(X.a,null,e),r.a.createElement(X.a,null,r.a.createElement(p.a,{type:"close-square",onClick:this.handleRemove})))}}]),t}(r.a.Component),ge=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getCategoryName",value:function(e){return this.props.categories.reduce((function(t,a){if(t)return t;var n=a.get("children"),r=n.findIndex((function(t){return t.get("id")===e}));if(-1===r)return t;var o=n.get(r);return o.get("id")===a.get("id")?a.get("name"):"".concat(a.get("name"),"(").concat(o.get("name"),")")}),void 0)}},{key:"render",value:function(){var e=this,t=this.props,a=t.files,n=t.removeFile,o=a.groupBy((function(e){return e.get("categoryId")})).entrySeq();return r.a.createElement("div",{className:"huali-file-collapse-wrapper"},r.a.createElement(fe.a,{defaultActiveKey:o.getIn([0,0])},o.toJS().map((function(t){var a=Object(de.a)(t,2),o=a[0],i=a[1];return r.a.createElement(fe.a.Panel,{key:o,header:e.getCategoryName(o),extra:r.a.createElement(me.a,{count:i.length})},i.map((function(t){return r.a.createElement(he,{key:t.id,id:t.id,name:(a=t.covers,a[1]?"".concat(a[0],"(").concat(a[1],")"):a[0]),onRemove:n,onModify:e.handleModifyFile});var a})))}))))}}]),t}(r.a.Component),ve=Object(k.connect)((function(e){var t=e.category;return{files:e.fileInput.get("files"),categories:t.get("dataSource")}}),{removeFile:function(e){return{type:"fileInput/removeFile",payload:e}}})(ge),ye=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.count;return r.a.createElement("div",{style:{margin:10}},r.a.createElement(h.a,{style:{width:"100%"}},"\u5df2\u8bbe\u7f6e ".concat(e," \u4e2a\u6587\u4ef6\uff0c\u5168\u90e8\u5bfc\u51fa")))}}]),t}(r.a.Component),be=Object(k.connect)((function(e){return{count:e.fileInput.get("files").size}}))(ye),Oe=(a(541),{width:"100%",height:8,backgroundColor:"#f0f2f5"});var je=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ve,null),r.a.createElement("div",{style:Oe}),r.a.createElement(be,null))},Ce=i.a.Sider,Ee=i.a.Content,Ie={marginRight:410},ke=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(a=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).formRef=r.a.createRef(),a.getChildContext=function(){return{formRef:a.formRef}},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(i.a,null,r.a.createElement(Ee,{style:Ie},r.a.createElement(se,null)),r.a.createElement(Ce,{theme:"light",width:400,className:"huali-file-sider"},r.a.createElement(je,null)))}}]),t}(r.a.Component);ke.childContextTypes={formRef:I.a.object};var we=ke,Se={width:"100%",height:"8px"};var Me=function(){return r.a.createElement("div",{style:Se})};var Re=function(e){var t=e.align,a=e.children,n={textAlign:"left"};return"right"===t&&(n.textAlign="right"),r.a.createElement("div",{style:n},a)},xe={padding:10,backgroundColor:"rgb(255, 255, 255)"};function Le(e){var t=e.children;return r.a.createElement("div",{style:xe},t)}Le.PageSpacing=Me,Le.PageTextAlign=Re;var Te=Le,Fe=a(560);a(542);var Ae=function(e){return e.options.map((function(e,t){var a=e.text,n=e.onClick;return r.a.createElement(r.a.Fragment,{key:t},t>0&&r.a.createElement(Fe.a,{type:"vertical"}),r.a.createElement(h.a,{type:"link",onClick:n,className:"huali-operate-group-item"},a))}))},De=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleRemove",value:function(e,t){var a=this.props.removeCatalog;pe.a.confirm({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u76ee\u5f55 ".concat(t.name," \u5417\uff1f"),content:"\u5220\u9664\u76ee\u5f55\u540e\uff0c\u5206\u7c7b\u4e2d\u7684\u76f8\u5173\u6570\u636e\u4e5f\u4f1a\u6e05\u9664\u3002",onOk:function(){a(e)}})}},{key:"getColumns",value:function(){var e=this,t=this.props.showModal;return[{width:50,title:"\u5e8f\u53f7",dataIndex:"id",render:function(e,t,a){return a+1}},{title:"\u76ee\u5f55\u540d\u79f0",dataIndex:"name"},{title:"\u9ed8\u8ba4\u9875\u53f7",dataIndex:"pn"},{width:120,title:"\u64cd\u4f5c",dataIndex:"$$operate",render:function(a,n,o){var i=[{text:"\u7f16\u8f91",onClick:function(){return t(n)}},{text:"\u5220\u9664",onClick:function(){return e.handleRemove(o,n)}}];return r.a.createElement(Ae,{options:i})}}]}},{key:"render",value:function(){var e=this.props.dataSource;return r.a.createElement(_.a,{rowKey:"id",columns:this.getColumns(),dataSource:e.toJS(),pagination:!1,footer:null,bordered:!0})}}]),t}(r.a.PureComponent),Pe={showModal:function(e){return{type:"catalog/updateEditModalInfo",payload:Object(D.a)({},e,{visible:!0})}},removeCatalog:function(e){return{type:"catalog/removeCatalog",payload:e}}},Ne=Object(k.connect)((function(e){return{dataSource:e.catalog.get("dataSource")}}),Pe)(De),Je=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleOk=a.handleOk.bind(Object(N.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleOk",value:function(){var e=this.props,t=e.form,a=e.modifyCatalogs;return new Promise((function(e,n){t.validateFields({force:!0},(function(t,n){t||(a(n),e())}))}))}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.catalogs,n=e.closeModal,o=e.editModalInfo,i=t.getFieldDecorator,c={visible:o.get("visible")};return o.get("isCreate")?(c.title="\u65b0\u589e\u76ee\u5f55",c.contrast=a):(c.title="\u7f16\u8f91\u76ee\u5f55",c.contrast=a.filter((function(e){return e.get("id")!==o.get("id")})),c.defaultPn=o.get("pn"),c.defaultName=o.get("name")),r.a.createElement(pe.a,{title:c.title,visible:c.visible,onOk:this.handleOk,onCancel:n,maskClosable:!1,destroyOnClose:!0},r.a.createElement(S.a,F,r.a.createElement(S.a.Item,{label:"\u76ee\u5f55\u540d\u79f0"},i("name",{initialValue:c.defaultName,rules:[{required:!0,message:"\u76ee\u5f55\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"},{validator:function(e,t,a){return function(e,t,a){a.find((function(t){return t.get("name")===e.trim()}))?t("\u8fd9\u4e2a\u76ee\u5f55\u5df2\u5b58\u5728\uff0c\u8bf7\u4fee\u6539\u3002"):t()}(t,a,c.contrast)}}]})(r.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u76ee\u5f55\u540d\u79f0"}))),r.a.createElement(S.a.Item,{label:"\u9ed8\u8ba4\u9875\u53f7"},i("pn",{initialValue:c.defaultPn})(r.a.createElement(ee.a,{min:0,max:300,placeholder:"\u8bf7\u8f93\u5165\u9ed8\u8ba4\u9875\u53f7",style:{width:"100%"}})))))}}]),t}(r.a.PureComponent),Ke=Object(k.connect)((function(e){var t=e.catalog;return{catalogs:t.get("dataSource"),editModalInfo:t.get("editModalInfo")}}),{closeModal:function(){return{type:"catalog/updateEditModalInfo",payload:{visible:!1}}},modifyCatalogs:function(e){return{type:"catalog/modifyCatalogs",payload:e}}})(S.a.create()(Je)),qe=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.showModal;return r.a.createElement(h.a,{type:"primary",onClick:e},"\u65b0\u589e\u76ee\u5f55")}}]),t}(r.a.Component),Ge=Object(k.connect)(null,{showModal:function(){return{type:"catalog/updateEditModalInfo",payload:{visible:!0,isCreate:!0}}}})(qe);var _e=function(){return r.a.createElement(Te,null,r.a.createElement(Te.PageTextAlign,{align:"right"},r.a.createElement(Ge,null),r.a.createElement(Ke,null)),r.a.createElement(Te.PageSpacing,null),r.a.createElement(Ne,null))},Ve=a(567),Be=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleRemove",value:function(e,t){var a=this.props.removeCategory;pe.a.confirm({title:"\u4f60\u786e\u5b9a\u8981\u5220\u9664\u5206\u7c7b ".concat(t.name," \u5417\uff1f"),content:"\u5220\u9664\u5206\u7c7b\u540e\uff0c\u5b50\u5206\u7c7b\u4e5f\u4f1a\u4e00\u8d77\u5220\u9664",onOk:function(){a(e)}})}},{key:"handleModify",value:function(e){var t=e.id,a=e.name,n=e.children;(0,this.props.showModifyModal)({id:t,name:a,children:n.filter((function(e){return!e.isDefault}))})}},{key:"getColumns",value:function(){var e=this,t=this.props.showRelationModal;return[{width:50,title:"\u5e8f\u53f7",dataIndex:"id",render:function(e,t,a){return a+1}},{title:"\u5206\u7c7b\u540d\u79f0",dataIndex:"name"},{title:"\u4e8c\u7ea7\u5206\u7c7b",dataIndex:"children",render:function(e){return e.map((function(e){var t=e.isDefault?{disabled:!0}:{code:!0};return r.a.createElement(Ve.a.Text,Object.assign({key:e.id},t),e.name)}))}},{width:200,title:"\u7ed1\u5b9a\u76ee\u5f55",dataIndex:"menus",render:function(e,a){var n={onClick:function(){return t(a.id)}};return Object(W.isArray)(e)&&e.length?n.text="\u5df2\u7ed1\u5b9a\u76ee\u5f55 ".concat(e.length," \u6761\uff0c\u53bb\u4fee\u6539"):n.text="\u672a\u7ed1\u5b9a\u76ee\u5f55\uff0c\u73b0\u5728\u5c31\u53bb\u7ed1\u5b9a",r.a.createElement(Ae,{options:[n]})}},{width:120,title:"\u64cd\u4f5c",dataIndex:"$$operate",render:function(t,a,n){var o=[{text:"\u7f16\u8f91",onClick:function(){return e.handleModify(a)}},{text:"\u5220\u9664",onClick:function(){return e.handleRemove(n,a)}}];return r.a.createElement(Ae,{options:o})}}]}},{key:"getDataSource",value:function(){var e=this.props,t=e.relations,a=e.categories,n=t.groupBy((function(e){return e.get("categoryId")}));return a.map((function(e){return e.set("menus",n.get(e.get("id"))||Object(w.a)())})).toJS()}},{key:"render",value:function(){return r.a.createElement(_.a,{rowKey:"id",columns:this.getColumns(),dataSource:this.getDataSource(),childrenColumnName:null,pagination:!1,footer:null,bordered:!0})}}]),t}(r.a.PureComponent),Ue={showModifyModal:function(e){return{type:"category/updateEditModalInfo",payload:Object(D.a)({},e,{visible:!0})}},showRelationModal:function(e){return{type:"category/showRelationModal",payload:e}},removeCategory:function(e){return{type:"category/removeCategory",payload:e}}},ze=Object(k.connect)((function(e){var t=e.category;return{relations:t.get("relations"),categories:t.get("dataSource")}}),Ue)(Be),Ye=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.showModal;return r.a.createElement(h.a,{type:"primary",onClick:e},"\u65b0\u589e\u5206\u7c7b")}}]),t}(r.a.PureComponent),$e=Object(k.connect)(null,{showModal:function(){return{type:"category/updateEditModalInfo",payload:{visible:!0,isCreate:!0}}}})(Ye),He=function(e,t,a){if(Object(W.isArray)(t))if(t.length){var n=t.reduce((function(e,a){return e||(a.name?!!t.some((function(e){var t=e.id,n=e.name;return t!==a.id&&n===a.name}))&&"\u4e8c\u7ea7\u5206\u7c7b\u540d\u79f0\u91cd\u590d":"\u4e8c\u7ea7\u5206\u7c7b\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a")}),!1);n?a(n):a()}else a();else a()},We=a(571),Qe=(a(544),function(e){return Object(W.isArray)(e)?e:[]}),Xe=function(e){function t(e){var a;Object(c.a)(this,t),a=Object(u.a)(this,Object(s.a)(t).call(this,e));var n=e.value;return a.state={value:Qe(n),prevValue:n},a.handleCreate=a.handleCreate.bind(Object(N.a)(a)),a.handleRemove=a.handleRemove.bind(Object(N.a)(a)),a.handleInputBlur=a.handleInputBlur.bind(Object(N.a)(a)),a.handleInputChange=a.handleInputChange.bind(Object(N.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){return!Object(W.isEqual)(t.value,this.state.value)||!Object(W.isEqual)(e.visible,this.props.visible)}},{key:"handleCreate",value:function(){var e=Date.now(),t=this.state.value,a=this.props.onChange,n=[{id:e}].concat(Object(P.a)(t));this.setState({value:n},(function(){a(n)}))}},{key:"handleRemove",value:function(e){var t=this.state.value,a=this.props.onChange,n=t.filter((function(t){return t.id!==e}));this.setState({value:n},(function(){a(n)}))}},{key:"handleInputChange",value:function(e,t){var a=this.state.value,n=this.props.onChange,r=a.map((function(a){return a.id===e?Object(D.a)({},a,{name:t}):a}));this.setState({value:r},(function(){n(r)}))}},{key:"handleInputBlur",value:function(){var e=this.state.value;(0,this.props.onChange)(e.map((function(e){return Object(D.a)({},e,{name:Object(W.trim)(e.name)})})))}},{key:"render",value:function(){var e=this,t=this.state.value;return r.a.createElement(We.a,{className:"huali-sub-catagory-list",header:r.a.createElement("a",{href:!0,onClick:this.handleCreate},"\u6dfb\u52a0"),bordered:!0},!t.length&&r.a.createElement(We.a.Item,{key:"default"},"\u9ed8\u8ba4"),t.map((function(t){var a=t.id,n=t.name;return r.a.createElement(We.a.Item,{key:a,actions:[r.a.createElement(p.a,{type:"close-circle",onClick:function(){return e.handleRemove(a)}})]},r.a.createElement(L.a,{value:n,onBlur:e.handleInputBlur,onChange:function(t){return e.handleInputChange(a,t.target.value)}}))})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!Object(W.isEqual)(e.value,t.prevValue)){var a=e.value;return{value:Qe(a),prevValue:a}}return null}}]),t}(r.a.Component),Ze=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(s.a)(t).call(this,e))).handleOk=a.handleOk.bind(Object(N.a)(a)),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"handleOk",value:function(){var e=this.props,t=e.form,a=e.modifyCategories;return new Promise((function(e,n){t.validateFields({force:!0},(function(t,n){t||(a(n),e())}))}))}},{key:"render",value:function(){var e=this.props,t=e.form,a=e.categories,n=e.closeModal,o=e.editModalInfo,i=t.getFieldDecorator,c={visible:o.get("visible")};if(o.get("isCreate"))c.title="\u521b\u5efa\u5206\u7c7b",c.contrast=a;else{c.title="\u7f16\u8f91\u5206\u7c7b",c.contrast=a.filter((function(e){return e.get("id")!==o.get("id")})),c.defaultName=o.get("name");var l=o.get("children");l&&(c.defaultChildren=l.toJS())}return r.a.createElement(pe.a,{title:c.title,visible:c.visible,onOk:this.handleOk,onCancel:n,maskClosable:!1,destroyOnClose:!0},r.a.createElement(S.a,F,r.a.createElement(S.a.Item,{label:"\u4e00\u7ea7\u5206\u7c7b"},i("name",{initialValue:c.defaultName,rules:[{required:!0,message:"\u6587\u4ef6\u7c7b\u578b\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"},{validator:function(e,t,a){return function(e,t,a){a.find((function(t){return t.get("name")===e.trim()}))?t("\u8fd9\u4e2a\u5206\u7c7b\u5df2\u5b58\u5728\uff0c\u8bf7\u4fee\u6539\u3002"):t()}(t,a,c.contrast)}}]})(r.a.createElement(L.a,{placeholder:"\u8bf7\u8f93\u5165\u6587\u4ef6\u7c7b\u578b\u540d\u79f0"}))),r.a.createElement(S.a.Item,{label:"\u4e8c\u7ea7\u5206\u7c7b"},i("children",{initialValue:c.defaultChildren,rules:[{validator:He}]})(r.a.createElement(Xe,null)))))}}]),t}(r.a.Component),et=Object(k.connect)((function(e){var t=e.category;return{categories:t.get("dataSource"),editModalInfo:t.get("editModalInfo")}}),{closeModal:function(){return{type:"category/updateEditModalInfo",payload:{visible:!1}}},modifyCategories:function(e){return{type:"category/modifyCategories",payload:e}}})(S.a.create()(Ze)),tt=a(569),at=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.catalogs,a=e.closeModal,n=e.updateTargetKeys,o=e.relationModalInfo,i=e.confirmSaveRelations,c=o.toJS(),l=c.visible,u=c.targetKeys;return r.a.createElement(pe.a,{title:"\u5173\u8054\u76ee\u5f55",visible:l,onOk:i,onCancel:a,maskClosable:!1,destroyOnClose:!0},r.a.createElement(tt.a,{className:"ant-transfer-customize-list",rowKey:function(e){return e.id},render:function(e){return e.name},targetKeys:u,dataSource:t.toJS(),onChange:n}))}}]),t}(r.a.Component),nt=Object(k.connect)((function(e){var t=e.catalog,a=e.category;return{catalogs:t.get("dataSource"),relationModalInfo:a.get("relationModalInfo")}}),{closeModal:function(){return{type:"category/hideRelationModal"}},updateTargetKeys:function(e){return{type:"category/updateTargetKeys",payload:e}},confirmSaveRelations:function(){return{type:"category/confirmSaveRelations"}}})(at),rt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(Te,null,r.a.createElement(Te.PageTextAlign,{align:"right"},r.a.createElement($e,null)),r.a.createElement(Te.PageSpacing,null),r.a.createElement(ze,null),r.a.createElement(et,null),r.a.createElement(nt,null))}}]),t}(r.a.Component),ot=i.a.Content,it={height:"100vh",overflow:"hidden",overflowY:"auto",padding:"75px 10px 0"},ct=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(ot,{style:it},r.a.createElement(o.Switch,null,r.a.createElement(o.Route,{path:g.b.CATALOG,render:function(){return r.a.createElement(o.Switch,null,r.a.createElement(o.Route,{path:g.b.CATALOG_LIST,component:_e}),r.a.createElement(o.Redirect,{to:g.b.CATALOG_LIST}))}}),r.a.createElement(o.Route,{path:g.b.CATEGORY,render:function(){return r.a.createElement(o.Switch,null,r.a.createElement(o.Route,{path:g.b.CATEGORY_LIST,component:rt}),r.a.createElement(o.Redirect,{to:g.b.CATEGORY_LIST}))}}),r.a.createElement(o.Route,{path:g.b.FILE_INPUT,component:we}),r.a.createElement(o.Redirect,{to:g.b.FILE_INPUT})))}}]),t}(r.a.Component);t.default=function(e){var t=e.history;return r.a.createElement(o.Router,{history:t},r.a.createElement(i.a,null,r.a.createElement(C,null),r.a.createElement(ct,null)))}},558:function(e,t,a){"use strict";a.r(t);var n=a(29),r=a.n(n),o=a(1),i=a.n(o),c=a(9),l=a.n(c),u=a(8),s=a(280);a(392),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(393);var d=a(41).createHashHistory,f=r()({history:d()});f.model(a(394).default),f.model(a(395).default),f.model(a(396).default),f.router(a(556).default);var m=f.start();l.a.render(i.a.createElement(u.c,{locale:s.a},i.a.createElement(m,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[285,1,2]]]);
//# sourceMappingURL=main.807e7434.chunk.js.map